{% extends 'base.html' %}

{% block extra_css %}
<!-- Bootstrap 5 -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- DataTables CSS -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css">

<style>
  .user-container {
    background-color: #f8f9fa;
    padding: 2rem;
    border-radius: 15px;
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.1);
    position: relative; /* needed for absolute positioning of button */
  }

  .user-header {
    color: #0d6efd;
    font-weight: 700;
    margin-bottom: 2rem;
    text-align: center;
    position: relative;
    padding-bottom: 0.5rem;
  }

  .user-header:after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 100px;
    height: 3px;
    background: #0d6efd;
  }

  /* Go Back to Home button */
  .go-home-btn {
    position: absolute;
    top: 1rem;
    right: 1rem;
  }

  .user-table {
    background-color: white;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
  }

  .user-table thead {
    background-color: #0d6efd;
    color: white;
  }

  .user-table th {
    padding: 1rem;
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.85rem;
    letter-spacing: 0.5px;
  }

  .user-table td {
    padding: 1rem;
    vertical-align: middle;
  }

  .user-table tbody tr:hover {
    background-color: rgba(13, 110, 253, 0.05);
  }

  .delete-btn {
    transition: all 0.3s ease;
  }

  .delete-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }

  .empty-message {
    color: #6c757d;
    font-style: italic;
    padding: 2rem;
    text-align: center;
  }
</style>
{% endblock extra_css %}

{% block content %}
<div class="container-fluid py-5">
  <div class="user-container">
    <h2 class="user-header">User List</h2>

    <!-- Go Back to Home Button -->
    <a href="{% url 'home' %}" class="btn btn-outline-secondary go-home-btn">
      <i class="fas fa-arrow-left me-1"></i> Home
    </a>

    <div class="table-responsive">
      <table id="userTable" class="table user-table table-hover w-100">
        <thead>
          <tr>
            <th scope="col">User ID</th>
            <th scope="col">Name</th>
            <th scope="col">Gender</th>
            <th scope="col">Mobile</th>
            <th scope="col">Address</th>
            <th scope="col">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for person in people %}
          <tr>
            <td>{{ person.id }}</td>
            <td>{{ person.first_name }} {{ person.surname }}</td>
            <td>{{ person.gender }}</td>
            <td>{{ person.mobile }}</td>
            <td>{{ person.address }}</td>
            <td>
              <a href="{% url 'delete_people' person.id %}"
                 onclick="return confirm('Are you sure you want to delete this person?')"
                 class="btn btn-sm btn-danger delete-btn">
                 <i class="fas fa-trash-alt me-1"></i> Delete
              </a>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="6" class="empty-message">
              No people available at the moment.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="mt-3">
      <div id="customPrintBtnContainer" class="d-flex justify-content-start"></div>
    </div>

  </div>
</div>
{% endblock content %}

{% block extra_js %}
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>

<script>
  $(document).ready(function() {
    var table = $('#userTable').DataTable({
      dom: 't', // Only the table, no built-in buttons on top
      buttons: [
        {
          extend: 'print',
          text: '<i class="fas fa-print me-1"></i> Print',
          className: 'btn btn-outline-primary',
          exportOptions: {
            columns: ':not(:last-child)'
          }
        }
      ],
      responsive: true,
      language: {
        search: "_INPUT_",
        searchPlaceholder: "Search users...",
      }
    });

    table.buttons().container().appendTo('#customPrintBtnContainer');
  });
</script>
{% endblock extra_js %}
